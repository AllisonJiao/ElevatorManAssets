#usda 1.0
(
    customLayerData = {
        dictionary cameraSettings = {
            dictionary Front = {
                double3 position = (5, 0, 0)
                double radius = 5
            }
            dictionary Perspective = {
                double3 position = (-0.3288464486634837, 9.852341679358869, 6.180562521360917)
                double3 target = (4.31316732940612e-7, -3.2390005344495876e-7, 2.00000085349589)
            }
            dictionary Right = {
                double3 position = (0, -5, 0)
                double radius = 5
            }
            dictionary Top = {
                double3 position = (0, 0, 5)
                double radius = 5
            }
            string boundCamera = "/OmniverseKit_Persp"
        }
        dictionary omni_layer = {
            string authoring_layer = "./rigid_body_elevator.usdc"
            dictionary locked = {
            }
            dictionary muteness = {
            }
        }
        dictionary physicsSettings = {
            int "/persistent/simulation/minFrameRate" = 60
            bool "/physics/updateParticlesToUsd" = 0
            bool "/physics/updateToUsd" = 0
            bool "/physics/updateVelocitiesToUsd" = 0
        }
        dictionary renderSettings = {
            bool "rtx:ambientOcclusion:enabled" = 0
            bool "rtx:indirectDiffuse:enabled" = 0
            int "rtx:pathtracing:maxSamplesPerLaunch" = 1000000
            int "rtx:post:dlss:execMode" = 1
            bool "rtx:reflections:enabled" = 0
            double "rtx:sceneDb:ambientLightIntensity" = 1
            bool "rtx:translucency:enabled" = 0
            int "rtx:viewTile:limit" = 1000000
        }
    }
    endTimeCode = 1000000
    metersPerUnit = 1
    startTimeCode = 0
    timeCodesPerSecond = 60
    upAxis = "Z"
)

def "Render" (
    hide_in_stage_window = true
    no_delete = true
)
{
    def "OmniverseKit"
    {
        def "HydraTextures" (
            hide_in_stage_window = true
            no_delete = true
        )
        {
            def RenderProduct "omni_kit_widget_viewport_ViewportTexture_0" (
                prepend apiSchemas = ["OmniRtxSettingsCommonAdvancedAPI_1", "OmniRtxSettingsRtAdvancedAPI_1", "OmniRtxSettingsPtAdvancedAPI_1", "OmniRtxPostColorGradingAPI_1", "OmniRtxPostChromaticAberrationAPI_1", "OmniRtxPostBloomPhysicalAPI_1", "OmniRtxPostMatteObjectAPI_1", "OmniRtxPostCompositingAPI_1", "OmniRtxPostDofAPI_1", "OmniRtxPostMotionBlurAPI_1", "OmniRtxPostTvNoiseAPI_1", "OmniRtxPostTonemapIrayReinhardAPI_1", "OmniRtxPostDebugSettingsAPI_1", "OmniRtxDebugSettingsAPI_1"]
                hide_in_stage_window = true
                no_delete = true
            )
            {
                rel camera = </OmniverseKit_Persp>
                token omni:rtx:background:source:texture:textureMode = "repeatMirrored"
                token omni:rtx:background:source:type = "domeLight"
                bool omni:rtx:material:db:nonVisualMaterialCSV:enabled = 0
                token omni:rtx:post:dlss:execMode = "balanced"
                bool omni:rtx:post:registeredCompositing:invertColorCorrection = 1
                bool omni:rtx:post:registeredCompositing:invertToneMap = 1
                int omni:rtx:pt:clampSpp = 64
                bool omni:rtx:pt:lightcache:cached:dontResolveConflicts = 1
                int omni:rtx:pt:maxSamplesPerLaunch = 1000000
                int omni:rtx:pt:maxVolumeBounces = 4
                int omni:rtx:pt:mgpu:maxPixelsPerRegionExponent = 12
                int omni:rtx:pt:samplesPerIteration = 64
                int omni:rtx:pt:samplesPerPixel = 64
                color3f omni:rtx:rt:ambientLight:color = (0.1, 0.1, 0.1)
                float omni:rtx:rt:ambientLight:intensity = 1
                bool omni:rtx:rt:ambientocclusion:enabled = 0
                bool omni:rtx:rt:demoire = 0
                bool omni:rtx:rt:ecoMode:enabled
                bool omni:rtx:rt:indirectdiffuse:enabled = 0
                bool omni:rtx:rt:lightcache:spatialCache:dontResolveConflicts = 1
                bool omni:rtx:rt:reflections:enabled = 0
                bool omni:rtx:rt:refractions:enabled = 0
                uint omni:rtx:viewTile:limit = 1000000
                rel orderedVars = </Render/Vars/LdrColor>
                custom bool overrideClipRange = 0
                uniform int2 resolution = (1280, 720)
            }
        }
    }

    def RenderSettings "OmniverseGlobalRenderSettings" (
        prepend apiSchemas = ["OmniRtxSettingsGlobalRtAdvancedAPI_1", "OmniRtxSettingsGlobalPtAdvancedAPI_1"]
        no_delete = true
    )
    {
        rel products = </Render/OmniverseKit/HydraTextures/omni_kit_widget_viewport_ViewportTexture_0>
    }

    def "Vars"
    {
        def RenderVar "LdrColor" (
            hide_in_stage_window = true
            no_delete = true
        )
        {
            uniform string sourceName = "LdrColor"
        }
    }
}

def PhysicsScene "physicsScene" (
    prepend apiSchemas = ["PhysxSceneAPI", "MaterialBindingAPI"]
)
{
    rel material:binding:physics = </physicsScene/defaultMaterial> (
        bindMaterialAs = "strongerThanDescendants"
    )
    vector3f physics:gravityDirection = (0, 0, -1)
    float physics:gravityMagnitude = 9.81
    float physxScene:bounceThreshold = 0.5
    uniform token physxScene:broadphaseType = "GPU"
    bool physxScene:enableCCD = 0
    bool physxScene:enableEnhancedDeterminism = 0
    bool physxScene:enableGPUDynamics = 1
    bool physxScene:enableSceneQuerySupport = 1
    bool physxScene:enableStabilization = 0
    float physxScene:frictionCorrelationDistance = 0.025
    float physxScene:frictionOffsetThreshold = 0.04
    uint physxScene:gpuCollisionStackSize = 67108864
    uint physxScene:gpuFoundLostAggregatePairsCapacity = 33554432
    uint physxScene:gpuFoundLostPairsCapacity = 2097152
    uint physxScene:gpuHeapCapacity = 67108864
    uint physxScene:gpuMaxNumPartitions = 8
    uint physxScene:gpuMaxParticleContacts = 1048576
    uint physxScene:gpuMaxRigidContactCount = 8388608
    uint physxScene:gpuMaxRigidPatchCount = 163840
    uint physxScene:gpuMaxSoftBodyContacts = 1048576
    uint64 physxScene:gpuTempBufferCapacity = 16777216
    uint physxScene:gpuTotalAggregatePairsCapacity = 2097152
    uniform uint physxScene:maxPositionIterationCount = 255
    uniform uint physxScene:maxVelocityIterationCount = 255
    uniform uint physxScene:minPositionIterationCount = 1
    uniform uint physxScene:minVelocityIterationCount = 0
    custom bool physxScene:solveArticulationContactLast = 0
    uniform token physxScene:solverType = "TGS"
    uint physxScene:timeStepsPerSecond = 60

    def Material "defaultMaterial" (
        prepend apiSchemas = ["PhysicsMaterialAPI", "PhysxMaterialAPI"]
    )
    {
        float physics:dynamicFriction = 0.5
        float physics:restitution = 0
        float physics:staticFriction = 0.5
        float physxMaterial:compliantContactDamping = 0
        float physxMaterial:compliantContactStiffness = 0
        uniform token physxMaterial:frictionCombineMode = "average"
        uniform token physxMaterial:restitutionCombineMode = "average"
    }
}

def "World"
{
    def Xform "defaultGroundPlane" (
        prepend references = @https://omniverse-content-production.s3-us-west-2.amazonaws.com/Assets/Isaac/5.1/Isaac/Environments/Grid/default_environment.usd@
    )
    {
        quatd xformOp:orient = (1, 0, 0, 0)
        double3 xformOp:scale = (1, 1, 1)
        double3 xformOp:translate = (0, 0, 0)
        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:orient", "xformOp:scale"]

        def Material "physicsMaterial" (
            prepend apiSchemas = ["PhysicsMaterialAPI", "PhysxMaterialAPI"]
        )
        {
            float physics:dynamicFriction = 0.5
            float physics:restitution = 0
            float physics:staticFriction = 0.5
            float physxMaterial:compliantContactDamping = 0
            float physxMaterial:compliantContactStiffness = 0
            uniform token physxMaterial:frictionCombineMode = "average"
            uniform token physxMaterial:restitutionCombineMode = "average"
        }

        over "GroundPlane"
        {
            over "CollisionPlane" (
                prepend apiSchemas = ["MaterialBindingAPI"]
            )
            {
                rel material:binding:physics = </World/defaultGroundPlane/physicsMaterial> (
                    bindMaterialAs = "strongerThanDescendants"
                )
            }
        }

        over "Environment"
        {
            float3 xformOp:scale = (1, 1, 1)
        }

        over "Looks"
        {
            over "theGrid"
            {
                over "Shader"
                {
                    color3f inputs:diffuse_tint = (0, 0, 0)
                }
            }
        }

        over "SphereLight"
        {
            token visibility = "invisible"
        }
    }

    def DomeLight "Light"
    {
        color3f inputs:color = (0.75, 0.75, 0.75)
        float inputs:colorTemperature = 6500
        bool inputs:enableColorTemperature = 0
        float inputs:exposure = 0
        float inputs:intensity = 3000
        bool inputs:normalize = 0
        asset inputs:texture:file
        token inputs:texture:format = "automatic"
        bool visibleInPrimaryRay = 1
        quatd xformOp:orient = (1, 0, 0, 0)
        double3 xformOp:scale = (1, 1, 1)
        double3 xformOp:translate = (0, 0, 0)
        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:orient", "xformOp:scale"]
    }

    def Xform "Elevator" (
        prepend apiSchemas = ["PhysicsArticulationRootAPI", "PhysxArticulationAPI"]
        prepend references = @ElevatorManAssets/assets/elevator_rigged.usdc@
    )
    {
        quatd xformOp:orient = (1, 0, 0, 0)
        double3 xformOp:scale = (1, 1, 1)
        double3 xformOp:translate = (0, 0, 0)
        uniform token[] xformOpOrder = ["xformOp:translate", "xformOp:orient", "xformOp:scale"]

        over "Elevator"
        {
            token visibility = "inherited"
        }

        over "ElevatorRig"
        {
            over "ElevatorButton_0_0" (
                prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
            )
            {
                bool physics:kinematicEnabled = 0
                bool physics:rigidBodyEnabled = 1

                over "Cube_031" (
                    prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
                )
                {
                    uniform token physics:approximation = "none"
                    bool physics:collisionEnabled = 1
                }

                def PhysicsPrismaticJoint "button_0_0_joint"
                {
                    uniform token physics:axis = "Y"
                    rel physics:body0 = </World/Elevator/ButtonsPanel>
                    rel physics:body1 = </World/Elevator/ElevatorRig/ElevatorButton_0_0>
                    float physics:breakForce = 3.4028235e38
                    float physics:breakTorque = 3.4028235e38
                    point3f physics:localPos0 = (0.110660076, 0.015116094, 0.010814908)
                    point3f physics:localPos1 = (0, 0, 0)
                    quatf physics:localRot0 = (1, 8.1460335e-8, 0, 0)
                    quatf physics:localRot1 = (1, 0, 0, 0)
                }
            }

            over "ElevatorButton_0_1" (
                prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
            )
            {
                bool physics:kinematicEnabled = 0
                bool physics:rigidBodyEnabled = 1

                over "Cube_032" (
                    prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
                )
                {
                    uniform token physics:approximation = "none"
                    bool physics:collisionEnabled = 1
                }

                def PhysicsPrismaticJoint "button_0_1_joint"
                {
                    uniform token physics:axis = "Y"
                    rel physics:body0 = </World/Elevator/ButtonsPanel>
                    rel physics:body1 = </World/Elevator/ElevatorRig/ElevatorButton_0_1>
                    float physics:breakForce = 3.4028235e38
                    float physics:breakTorque = 3.4028235e38
                    point3f physics:localPos0 = (-0.10933995, 0.015116094, 0.010814908)
                    point3f physics:localPos1 = (0, 0, 0)
                    quatf physics:localRot0 = (1, 8.1460335e-8, 0, 0)
                    quatf physics:localRot1 = (1, 0, 0, 0)
                }
            }

            over "ElevatorButton_1_0" (
                prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
            )
            {
                bool physics:kinematicEnabled = 0
                bool physics:rigidBodyEnabled = 1

                over "Cube_033" (
                    prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
                )
                {
                    uniform token physics:approximation = "none"
                    bool physics:collisionEnabled = 1
                }

                def PhysicsPrismaticJoint "button_1_0_joint"
                {
                    uniform token physics:axis = "Y"
                    rel physics:body0 = </World/Elevator/ButtonsPanel>
                    rel physics:body1 = </World/Elevator/ElevatorRig/ElevatorButton_1_0>
                    float physics:breakForce = 3.4028235e38
                    float physics:breakTorque = 3.4028235e38
                    point3f physics:localPos0 = (0.110660076, 0.015116123, -0.16718507)
                    point3f physics:localPos1 = (0, 0, 0)
                    quatf physics:localRot0 = (1, 8.1460335e-8, 0, 0)
                    quatf physics:localRot1 = (1, 0, 0, 0)
                }
            }

            over "ElevatorButton_1_1" (
                prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
            )
            {
                bool physics:kinematicEnabled = 0
                bool physics:rigidBodyEnabled = 1

                over "Cube_034" (
                    prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
                )
                {
                    uniform token physics:approximation = "none"
                    bool physics:collisionEnabled = 1
                }

                def PhysicsPrismaticJoint "button_1_1_joint"
                {
                    uniform token physics:axis = "Y"
                    rel physics:body0 = </World/Elevator/ButtonsPanel>
                    rel physics:body1 = </World/Elevator/ElevatorRig/ElevatorButton_1_1>
                    float physics:breakForce = 3.4028235e38
                    float physics:breakTorque = 3.4028235e38
                    point3f physics:localPos0 = (-0.10933995, 0.015116123, -0.16718507)
                    point3f physics:localPos1 = (0, 0, 0)
                    quatf physics:localRot0 = (1, 8.1460335e-8, 0, 0)
                    quatf physics:localRot1 = (1, 0, 0, 0)
                }
            }

            over "ElevatorButton_2_0" (
                prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
            )
            {
                bool physics:kinematicEnabled = 0
                bool physics:rigidBodyEnabled = 1

                over "Cube_035" (
                    prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
                )
                {
                    uniform token physics:approximation = "none"
                    bool physics:collisionEnabled = 1
                }

                def PhysicsPrismaticJoint "button_2_0_joint"
                {
                    uniform token physics:axis = "Y"
                    rel physics:body0 = </World/Elevator/ButtonsPanel>
                    rel physics:body1 = </World/Elevator/ElevatorRig/ElevatorButton_2_0>
                    float physics:breakForce = 3.4028235e38
                    float physics:breakTorque = 3.4028235e38
                    point3f physics:localPos0 = (0.110660076, 0.015116151, -0.34518504)
                    point3f physics:localPos1 = (0, 0, 0)
                    quatf physics:localRot0 = (1, 8.1460335e-8, 0, 0)
                    quatf physics:localRot1 = (1, 0, 0, 0)
                }
            }

            over "ElevatorButton_2_1" (
                prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
            )
            {
                bool physics:kinematicEnabled = 0
                bool physics:rigidBodyEnabled = 1

                over "Cube_036" (
                    prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
                )
                {
                    uniform token physics:approximation = "none"
                    bool physics:collisionEnabled = 1
                }

                def PhysicsPrismaticJoint "button_2_1_joint"
                {
                    uniform token physics:axis = "Y"
                    rel physics:body0 = </World/Elevator/ButtonsPanel>
                    rel physics:body1 = </World/Elevator/ElevatorRig/ElevatorButton_2_1>
                    float physics:breakForce = 3.4028235e38
                    float physics:breakTorque = 3.4028235e38
                    point3f physics:localPos0 = (-0.10933995, 0.015116151, -0.34518504)
                    point3f physics:localPos1 = (0, 0, 0)
                    quatf physics:localRot0 = (1, 8.1460335e-8, 0, 0)
                    quatf physics:localRot1 = (1, 0, 0, 0)
                }
            }

            over "ElevatorButton_3_0" (
                prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
            )
            {
                bool physics:kinematicEnabled = 0
                bool physics:rigidBodyEnabled = 1

                over "Cube_037" (
                    prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
                )
                {
                    uniform token physics:approximation = "none"
                    bool physics:collisionEnabled = 1
                }

                def PhysicsPrismaticJoint "button_3_0_joint"
                {
                    uniform token physics:axis = "Y"
                    rel physics:body0 = </World/Elevator/ButtonsPanel>
                    rel physics:body1 = </World/Elevator/ElevatorRig/ElevatorButton_3_0>
                    float physics:breakForce = 3.4028235e38
                    float physics:breakTorque = 3.4028235e38
                    point3f physics:localPos0 = (0.110660076, 0.015116181, -0.52318513)
                    point3f physics:localPos1 = (0, 0, 0)
                    quatf physics:localRot0 = (1, 8.1460335e-8, 0, 0)
                    quatf physics:localRot1 = (1, 0, 0, 0)
                }
            }

            over "ElevatorButton_3_1" (
                prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
            )
            {
                bool physics:kinematicEnabled = 0
                bool physics:rigidBodyEnabled = 1

                over "Cube_038" (
                    prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
                )
                {
                    uniform token physics:approximation = "none"
                    bool physics:collisionEnabled = 1
                }

                def PhysicsPrismaticJoint "button_3_1_joint"
                {
                    uniform token physics:axis = "Y"
                    rel physics:body0 = </World/Elevator/ButtonsPanel>
                    rel physics:body1 = </World/Elevator/ElevatorRig/ElevatorButton_3_1>
                    float physics:breakForce = 3.4028235e38
                    float physics:breakTorque = 3.4028235e38
                    point3f physics:localPos0 = (-0.10933995, 0.015116181, -0.52318513)
                    point3f physics:localPos1 = (0, 0, 0)
                    quatf physics:localRot0 = (1, 8.1460335e-8, 0, 0)
                    quatf physics:localRot1 = (1, 0, 0, 0)
                }
            }

            over "Door1" (
                prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
            )
            {
                bool physics:kinematicEnabled = 0
                bool physics:rigidBodyEnabled = 1

                over "Cube_026" (
                    prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
                )
                {
                    uniform token physics:approximation = "none"
                    bool physics:collisionEnabled = 1
                }

                def PhysicsPrismaticJoint "door1_joint"
                {
                    uniform token physics:axis = "X"
                    rel physics:body0 = </World/Elevator/Wall>
                    rel physics:body1 = </World/Elevator/ElevatorRig/Door1>
                    float physics:breakForce = 3.4028235e38
                    float physics:breakTorque = 3.4028235e38
                    point3f physics:localPos0 = (0.18528906, 0.09457121, -0.5997218)
                    point3f physics:localPos1 = (0, 0, 0)
                    quatf physics:localRot0 = (1, 3.4008218e-10, 6.124409e-15, -3.7591356e-8)
                    quatf physics:localRot1 = (1, 0, 0, 0)
                }
            }

            over "Door2" (
                prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
            )
            {
                bool physics:kinematicEnabled = 0
                bool physics:rigidBodyEnabled = 1

                over "Cube_025" (
                    prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
                )
                {
                    uniform token physics:approximation = "none"
                    bool physics:collisionEnabled = 1
                }

                def PhysicsPrismaticJoint "door2_joint"
                {
                    uniform token physics:axis = "X"
                    rel physics:body0 = </World/Elevator/Wall>
                    rel physics:body1 = </World/Elevator/ElevatorRig/Door2/Cube_025>
                    float physics:breakForce = 3.4028235e38
                    float physics:breakTorque = 3.4028235e38
                    point3f physics:localPos0 = (1.1419111, 0.10672245, -0.5997219)
                    point3f physics:localPos1 = (0, 0, 0)
                    quatf physics:localRot0 = (1, 3.4008218e-10, 6.124409e-15, -3.7591356e-8)
                    quatf physics:localRot1 = (1, 0, 0, 0)
                }
            }
        }

        over "ButtonsPanel" (
            prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
        )
        {
            bool physics:kinematicEnabled = 0
            bool physics:rigidBodyEnabled = 1

            over "Cube_019" (
                prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
            )
            {
                uniform token physics:approximation = "none"
                bool physics:collisionEnabled = 1
            }
        }

        over "Wall" (
            prepend apiSchemas = ["PhysicsRigidBodyAPI", "PhysxRigidBodyAPI"]
        )
        {
            bool physics:kinematicEnabled = 0
            bool physics:rigidBodyEnabled = 1

            over "Cube_022" (
                prepend apiSchemas = ["PhysicsCollisionAPI", "PhysxCollisionAPI", "PhysxTriangleMeshCollisionAPI", "PhysicsMeshCollisionAPI"]
            )
            {
                uniform token physics:approximation = "none"
                bool physics:collisionEnabled = 1
            }
        }
    }
}

